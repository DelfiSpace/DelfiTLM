{% extends "admin/base.html" %}
{% block title %}DelfiSpace - Frame Processing{% endblock %}
{% load i18n static %}
{% block extrastyle %}{{ block.super }}<link rel="stylesheet" type="text/css" href="{% static "admin/css/forms.css" %}">{% endblock %}
{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'homepage' %}">{% translate 'Home' %}</a>
    &rsaquo; {% translate 'Processing' %}
</div>
{% endblock %}

{% block nav-sidebar %}{% endblock %}

{% block usertools %}
    {% if perms.transmission.view_downlink %}
    <a href="{% url 'get_frames_table' link='downlink'%}" >{% translate 'Downlink Transmission' %}</a>
    {% endif %}

    {% if perms.transmission.view_uplink %}
        <a href="{% url 'get_frames_table' link='uplink' %}" >{% translate 'Uplink Transmission' %}</a>
    {% endif %}

    {% if perms.transmission.view_uplink and perms.transmission.view_downlink %}
        <a href="{% url 'submit_job' %}" >{% translate 'Processing' %}</a>
    {% endif %}


    <a href="{% url 'account' %}">{% translate 'Account' %}</a>

{% endblock %}


{% block content %}

<h1>Scheduler Status: {{scheduler_status}}</h1>
{% if scheduler_status == "paused" %}
    <form action="{% url 'modify_scheduler' command='resume'%}" method="POST">{% csrf_token %}
        <input type="submit" value="Resume Scheduler">
    </form>
    <form action="{% url 'modify_scheduler' command='shutdown'%}" method="POST">{% csrf_token %}
       <input type="submit" value="Shutdown Scheduler">
    </form>
    <form action="{% url 'modify_scheduler' command='force shutdown'%}" method="POST">{% csrf_token %}
        <input type="submit" value="Force Shutdown Scheduler">
    </form>

{% endif %}
{% if scheduler_status == "shutdown" %}
    <form action="{% url 'modify_scheduler' command='start'%}" method="POST">{% csrf_token %}
        <input type="submit" value="Start Scheduler">
    </form>
{% endif %}

{% if scheduler_status == "running" %}
    <form action="{% url 'modify_scheduler' command='pause'%}" method="POST">{% csrf_token %}
        <input type="submit" value="Pause Scheduler">
    </form>
    <form action="{% url 'modify_scheduler' command='shutdown'%}" method="POST">{% csrf_token %}
       <input type="submit" value="Shutdown Scheduler">
    </form>
    <form action="{% url 'modify_scheduler' command='force shutdown'%}" method="POST">{% csrf_token %}
        <input type="submit" value="Force Shutdown Scheduler">
    </form>
{% endif %}

<br>
<br>

<h2>Submit job</h2>
<form class="post-form" method="POST">{% csrf_token %}
    <fieldset class="module aligned wide">
    {% for field in submit_job_form %}
        <div class="form-row">
            {{ field.errors }}
            {{ field.label_tag }}
            {{ field }}
        </div>
    {% endfor %}
    <input type="submit" value="Submit Job">
    </fieldset>
</form>

<p>[1]: Satellite will only be considered for scraping and bucket processing jobs.</p>
<br>
<p>[2]: Link will only be considered for bucket processing jobs.</p>
<br>
<br>
<p> Running jobs:</p>
    {% for job in running_jobs %}
        <p> - {{ job }} </p>
        <br>
    {% endfor %}

<p> Pending jobs:</p>
    {% for job in pending_jobs %}
        <p> - {{ job }} </p>
        <br>
    {% endfor %}

{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<br>
<br>


{% endblock %}
